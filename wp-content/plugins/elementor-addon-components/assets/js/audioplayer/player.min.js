(function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b:a.lunar=b()})(this,function(){'use strict';var a={};return a.hasClass=function(a,b){return new RegExp("(\\s|^)"+b+"(\\s|$)").test(a.attr("class"))},a.addClass=function(b,c){a.hasClass(b,c)||b.attr("class",(b.getAttribute("class")?b.getAttribute("class")+" ":"")+c)},a.removeClass=function(b,c){var d=b.attr("class").replace(new RegExp("(\\s|^)"+c+"(\\s|$)","g"),"$2");a.hasClass(b,c)&&b.attr("class",d)},a.toggleClass=function(b,c){a[a.hasClass(b,c)?"removeClass":"addClass"](b,c)},a.className=function(a,b){a.attr("class",b),console.log("className",a)},a}),function(b){var a={cursorPoint:function(b,c){a.settings.pt.x=b.clientX,a.settings.pt.y=b.clientY;var d=c.find("svg").attr("id");return d=document.getElementById(d),a.settings.pt.matrixTransform(d.getScreenCTM().inverse())},angle:function(a,b){var c=Math.atan2(b-50,a-50);return c*=180/Math.PI,c+=90,0>c&&(c=360+c),c},setGraphValue:function(c,d,e){var f=e.find(a.settings.audioObj),g=a.settings.pc,h=g-parseFloat(d/f[0].duration*g,10);b(c).css("strokeDashoffset",h),0===d&&(b(c).addClass(c,"done"),c===b(a.settings.progress)&&b(c).attr("class","ended"))},reportPosition:function(b,c){var d=b.find(a.settings.progress),e=b.find(a.settings.audioObj);a.setGraphValue(d,c.currentTime,b)},stopAllSounds:function(){document.addEventListener("play",function(a){for(var c=document.getElementsByTagName("audio"),d=0,e=c.length;d<e;d++)c[d]!=a.target&&c[d].pause(),c[d]!=a.target&&b(c[d]).parent("div").find(".playing").attr("class","paused")},!0)},settings:{},init:function(c){var d=["<svg viewBox=\"0 0 100 100\" id=\"playable\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" width=\"34\" height=\"34\" data-play=\"playable\" class=\"not-started playable\">","<g class=\"shape\">","<circle class=\"progress-track\" cx=\"50\" cy=\"50\" r=\"47.45\" stroke=\"#becce1\" stroke-opacity=\"0.25\" stroke-linecap=\"round\" fill=\"none\" stroke-width=\"5\"/>","<circle class=\"precache-bar\" cx=\"50\" cy=\"50\" r=\"47.45\" stroke=\"#302F32\" stroke-opacity=\"0.25\" stroke-linecap=\"round\" fill=\"none\" stroke-width=\"5\" transform=\"rotate(-90 50 50)\"/>","<circle class=\"progress-bar\" cx=\"50\" cy=\"50\" r=\"47.45\" stroke=\"#009EF8\" stroke-opacity=\"1\" stroke-linecap=\"round\" fill=\"none\" stroke-width=\"5\" transform=\"rotate(-90 50 50)\"/>","</g>","<circle class=\"controls\" cx=\"50\" cy=\"50\" r=\"45\" stroke=\"none\" fill=\"#000000\" opacity=\"0.0\" pointer-events=\"all\"/>","<g class=\"control pause\">","<line x1=\"40\" y1=\"35\" x2=\"40\" y2=\"65\" stroke=\"#000000\" fill=\"none\" stroke-width=\"8\" stroke-linecap=\"round\"/>","<line x1=\"60\" y1=\"35\" x2=\"60\" y2=\"65\" stroke=\"#000000\" fill=\"none\" stroke-width=\"8\" stroke-linecap=\"round\"/>","</g>","<g class=\"control play\">","<polygon points=\"45,35 65,50 45,65\" fill=\"#009EF8\" stroke-width=\"0\"></polygon>","</g>","<g class=\"control stop\">","<rect x=\"35\" y=\"35\" width=\"30\" height=\"30\" stroke=\"#000000\" fill=\"none\" stroke-width=\"1\"/>","</g>","</svg>"];d=d.join(" "),b.each(this,function(c){var a=b(this).find("audio");a.attr("id","audio"+c),d=d.replace("width=\"34\"","width=\""+a.data("size")+"\""),d=d.replace("height=\"34\"","height=\""+a.data("size")+"\""),d=d.replace("id=\"playable\"","id=\"playable"+c+"\""),b(this).append(d)});var e=b(this).find("svg").attr("id");e=document.getElementById(e),a.defaults={this:this,thisSelector:"",playObj:"playable",progress:".progress-bar",precache:".precache-bar",audioObj:"audio",controlsObj:".controls",pt:e.createSVGPoint(),pc:298.1371428256714},lunar={},a.settings=b.extend({},a.defaults,c),b(a.settings.controlsObj).on("click",function(c){var d=b(c.currentTarget).closest(b(a.settings.thisSelector)),e={el:d,activeAudio:d.find(a.settings.audioObj),playObj:d.find("[data-play]"),precache:d.find(a.settings.precache)};switch(e.class=e.playObj.attr("class"),e.class.replace("playable","").trim()){case"not-started":a.stopAllSounds(),e.activeAudio[0].play();var f=document.getElementById(e.activeAudio.attr("id"));f.addEventListener("timeupdate",function(){a.reportPosition(d,f)}),e.playObj.attr("class","playing");break;case"playing":e.playObj.attr("class","playable paused"),e.activeAudio[0].pause(),b(f).off("timeupdate");break;case"paused":e.playObj.attr("class","playable playing"),e.activeAudio[0].play();break;case"ended":e.playObj.attr("class","not-started playable"),e.activeAudio.off("timeupdate",a.reportPosition);}}),b(a.defaults.audioObj).on("progress",function(c){if(0<this.buffered.length){var d=this.buffered.end(this.buffered.length-1),e=b(c.currentTarget).parent().find(a.settings.precache),f=b(this).closest(b(a.settings.thisSelector));a.setGraphValue(e,d,f)}})}};b.fn.mediaPlayer=function(b){if(a[b])return a[b].apply(this,Array.prototype.slice.call(arguments,1));return"object"!=typeof b&&b?void console.log("Method "+b+" does not exist on jQuery.mediaPlayer"):a.init.apply(this,arguments)}}(jQuery);