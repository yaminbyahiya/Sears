{"version":3,"sources":["common-archive.js"],"names":["$","$body","$pageSidebars","Helpers","window","minimog","COLLAPSED_CLASS","COLLAPSIBLE_CLASS","initSelect2LayeredNavDropdown","each","$dropdown","this","selectWoo","placeholder","data","minimumResultsForSearch","width","allowClear","attr","language","noResults","$minimog","i18l","noMatchesFound","on","evt","preventDefault","off","updateLayoutSwitcherState","$grid","oldColumns","newColumns","$layoutSwitcher","length","$currentItem","find","siblings","removeClass","addClass","filterProductsByUrl","url","options","settings","extend","loadMore","scrollTop","$btnLoadMore","decodeURIComponent","history","pushState","document","body","trigger","ajax","type","dataType","success","response","$response","$gridWrapper","$newItems","children","remove","fragments","MinimogGridLayout","totalFragments","id","push","i","key","$key","empty","$newElement","html","offsetTop","offset","top","Math","max","animate","$thisSidebar","hasClass","stop","slideDown","fn","perfectScrollbar","isHandheld","beforeSend","setElementHandling","setBodyHandling","complete","unsetElementHandling","setBodyCompleted","ready","SELECTED_CLASS","lastST","$window","$el","$item","newLayout","newGridOptions","columns","disableColumnChange","$widget","not","wrapAll","closest","slideUp","$button","currentST","windowHeight","height","halfWH","parseInt","outerHeight","$link","parent","$list","href","toggleClass","unsetBodyOverflow","$form","$filter_input","slug","val","$filterName","$queryType","filterVal","addUrlParam","removeUrlParam","location","jQuery"],"mappings":"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","file":"../../common-archive.min.js","sourcesContent":["/**\n * Functions for archive pages.\n */\n(\n\tfunction( $ ) {\n\t\t'use strict';\n\n\t\tvar $body             = $( 'body' ),\n\t\t    $pageSidebars     = $( '.page-sidebar' ),\n\t\t    Helpers           = window.minimog.Helpers,\n\t\t    collapseDuration  = 250,\n\t\t    COLLAPSED_CLASS   = 'collapsed',\n\t\t    COLLAPSIBLE_CLASS = 'sidebar-widgets-collapsible';\n\n\t\t$( document ).ready( function() {\n\t\t\tinitArchiveLayoutSwitcher();\n\t\t\tinitArchiveSidebarWidgetsCollapsible();\n\t\t\thandlerScrollInfinite();\n\t\t\tinitSelect2LayeredNavDropdown();\n\n\t\t\t$( document.body ).on( 'MinimogGridLayoutColumnsChange', updateLayoutSwitcherState );\n\n\t\t\t$( document.body ).on( 'click', '.minimog-wp-widget-filter .filter-link', function( evt ) {\n\t\t\t\tevt.preventDefault();\n\n\t\t\t\tvar $link = $( this ),\n\t\t\t\t    $item = $link.parent( 'li' ),\n\t\t\t\t    $list = $link.closest( 'ul' ),\n\t\t\t\t    href  = $link.attr( 'href' );\n\n\t\t\t\tif ( $list.hasClass( 'single-choice' ) ) {\n\t\t\t\t\tif ( $item.hasClass( 'chosen' ) ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t$item.addClass( 'chosen' ).siblings().removeClass( 'chosen' );\n\t\t\t\t} else {\n\t\t\t\t\t$link.parent( 'li' ).toggleClass( 'chosen' );\n\t\t\t\t}\n\n\t\t\t\tvar $thisSidebar = $( this ).closest( '.page-sidebar' );\n\t\t\t\tif ( $thisSidebar.length > 0 ) {\n\t\t\t\t\t$body.removeClass( 'off-sidebar-opened' );\n\t\t\t\t\t$thisSidebar.removeClass( 'off-sidebar-active' );\n\t\t\t\t\tHelpers.unsetBodyOverflow();\n\t\t\t\t}\n\n\t\t\t\tfilterProductsByUrl( href );\n\t\t\t} );\n\n\t\t\t$( document.body ).on( 'click', '.js-product-filter-link', function( evt ) {\n\t\t\t\tevt.preventDefault();\n\n\t\t\t\tvar $link = $( this );\n\n\t\t\t\tif ( $link.hasClass( 'disabled' ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar href = $link.attr( 'href' );\n\n\t\t\t\tfilterProductsByUrl( href );\n\t\t\t} );\n\n\t\t\t$( document.body ).on( 'change', '.minimog-wp-widget-product-layered-nav-dropdown', function() {\n\t\t\t\tvar $form         = $( this ).closest( 'form' ),\n\t\t\t\t    $filter_input = $form.find( '.filter-name' ),\n\t\t\t\t    slug          = $( this ).val();\n\n\t\t\t\t$filter_input.val( slug );\n\t\t\t\t$form.trigger( 'submit' );\n\t\t\t} );\n\n\t\t\t$( document.body ).on( 'submit', '.minimog-wp-widget-product-layered-nav-form', function() {\n\t\t\t\tvar $form       = $( this ),\n\t\t\t\t    $filterName = $form.find( '.filter-name' ),\n\t\t\t\t    $queryType  = $form.find( '.filter-query-type' ),\n\t\t\t\t    filterVal   = $filterName.val(),\n\t\t\t\t    href        = $form.attr( 'action' );\n\n\t\t\t\thref = Helpers.addUrlParam( href, $filterName.attr( 'name' ), filterVal );\n\n\t\t\t\tif ( $queryType.length > 0 ) {\n\t\t\t\t\tif ( '' === filterVal ) {\n\t\t\t\t\t\thref = Helpers.removeUrlParam( href, $queryType.attr( 'name' ) );\n\t\t\t\t\t} else {\n\t\t\t\t\t\thref = Helpers.addUrlParam( href, $queryType.attr( 'name' ), $queryType.val() );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfilterProductsByUrl( href );\n\n\t\t\t\treturn false;\n\t\t\t} );\n\n\t\t\t$( document.body ).on( 'click', '.woocommerce-pagination a.page-numbers', function( evt ) {\n\t\t\t\tevt.preventDefault();\n\n\t\t\t\tfilterProductsByUrl( $( this ).attr( 'href' ), { scrollTop: 1 } );\n\t\t\t} );\n\n\t\t\t$( document.body ).on( 'click', '.shop-load-more-button', function( evt ) {\n\t\t\t\tevt.preventDefault();\n\t\t\t\tfilterProductsByUrl( $( this ).attr( 'data-url' ), { loadMore: 1 } );\n\t\t\t} );\n\n\t\t\t$( document.body ).on( 'change', '.js-product-ordering select.orderby', function() {\n\t\t\t\tvar url = Helpers.addUrlParam( window.location.href, 'orderby', $( this ).val() );\n\n\t\t\t\tfilterProductsByUrl( url );\n\t\t\t} );\n\t\t} );\n\n\t\t// Use Select2 enhancement if possible.\n\t\tif ( $.fn.selectWoo ) {\n\t\t\t$( document ).ready( function() {\n\t\t\t\tinitSelect2LayeredNavDropdown();\n\t\t\t} );\n\n\t\t\t$( document.body ).on( 'minimog_get_product_fragments_loaded', initSelect2LayeredNavDropdown );\n\t\t}\n\n\t\tfunction initSelect2LayeredNavDropdown() {\n\t\t\t$( '.minimog-wp-widget-product-layered-nav-dropdown' ).each( function() {\n\t\t\t\tvar $dropdown = $( this );\n\n\t\t\t\t$dropdown.selectWoo( {\n\t\t\t\t\tplaceholder: $dropdown.data( 'placeholder' ),\n\t\t\t\t\tminimumResultsForSearch: 5,\n\t\t\t\t\twidth: '100%',\n\t\t\t\t\tallowClear: ! $dropdown.attr( 'multiple' ),\n\t\t\t\t\tlanguage: {\n\t\t\t\t\t\tnoResults: function() {\n\t\t\t\t\t\t\treturn $minimog.i18l.noMatchesFound;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} ).on( 'select2:unselecting', function( evt ) {\n\t\t\t\t\t// We need close dropdown on unselecting to avoid bug on re-init.\n\t\t\t\t\t$( this ).on( \"select2:opening.cancelOpen\", function( evt ) {\n\t\t\t\t\t\tevt.preventDefault();\n\n\t\t\t\t\t\t$( this ).off( \"select2:opening.cancelOpen\" );\n\t\t\t\t\t} );\n\t\t\t\t} );\n\t\t\t} );\n\t\t}\n\n\t\tfunction updateLayoutSwitcherState( evt, $grid, oldColumns, newColumns ) {\n\t\t\tvar $layoutSwitcher = $( '#archive-layout-switcher' );\n\n\t\t\tif ( 0 >= $layoutSwitcher.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar $currentItem = $layoutSwitcher.find( '.switcher-item[data-columns=' + newColumns + ']' );\n\t\t\tif ( $currentItem.length > 0 ) {\n\t\t\t\t$currentItem.siblings().removeClass( 'selected' );\n\t\t\t\t$currentItem.addClass( 'selected' );\n\t\t\t}\n\t\t}\n\n\t\tfunction filterProductsByUrl( url, options = {} ) {\n\t\t\tvar settings = $.extend( true, {}, {\n\t\t\t\tloadMore: 0,\n\t\t\t\tscrollTop: 0\n\t\t\t}, options );\n\n\t\t\turl = decodeURIComponent( url );\n\n\t\t\tif ( ! settings.loadMore ) {\n\t\t\t\thistory.pushState( {}, null, url );\n\t\t\t}\n\n\t\t\tvar $btnLoadMore = $( '.shop-load-more-button' );\n\n\t\t\t$( document.body ).trigger( 'minimog_getting_product' );\n\n\t\t\t$.ajax( {\n\t\t\t\turl: url,\n\t\t\t\ttype: 'GET',\n\t\t\t\tdataType: 'html',\n\t\t\t\tsuccess: function( response ) {\n\t\t\t\t\tvar $response = $( response );\n\n\t\t\t\t\tvar $gridWrapper = $( '#minimog-main-post' );\n\n\t\t\t\t\tif ( ! settings.loadMore ) {\n\t\t\t\t\t\t$gridWrapper.children( '.minimog-grid' ).children( '.grid-item' ).remove();\n\t\t\t\t\t}\n\n\t\t\t\t\tvar $newItems = $response.find( '#minimog-main-post .grid-item' );\n\t\t\t\t\t$gridWrapper.MinimogGridLayout( 'update', $newItems );\n\n\t\t\t\t\tvar fragments = [\n\t\t\t\t\t\t'.woocommerce-result-count',\n\t\t\t\t\t\t'.woocommerce-pagination',\n\t\t\t\t\t\t'#active-filters-bar',\n\t\t\t\t\t];\n\n\t\t\t\t\tvar $filterWidgets = $( '.minimog-wp-widget-filter' );\n\n\t\t\t\t\t$filterWidgets.each( function() {\n\t\t\t\t\t\tvar id = $( this ).attr( 'id' );\n\t\t\t\t\t\tfragments.push( '#' + id );\n\t\t\t\t\t} );\n\n\t\t\t\t\tvar totalFragments = fragments.length;\n\n\t\t\t\t\tfor ( var i = 0; i < totalFragments; i ++ ) {\n\t\t\t\t\t\tvar key  = fragments[ i ],\n\t\t\t\t\t\t    $key = $( key );\n\n\t\t\t\t\t\tif ( $key.length > 0 ) {\n\t\t\t\t\t\t\t$key.empty();\n\t\t\t\t\t\t\tvar $newElement = $response.find( key );\n\t\t\t\t\t\t\tif ( $newElement.length > 0 ) {\n\t\t\t\t\t\t\t\t//$key.replaceWith( $newElement );\n\t\t\t\t\t\t\t\t$key.html( $newElement.html() );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t$( document.body ).trigger( 'minimog_get_product_fragments_loaded' );\n\n\t\t\t\t\tif ( settings.scrollTop ) {\n\t\t\t\t\t\tvar offsetTop = $gridWrapper.offset().top;\n\t\t\t\t\t\toffsetTop -= 198; // Header + topbar + filter bar.\n\t\t\t\t\t\toffsetTop = Math.max( 0, offsetTop );\n\n\t\t\t\t\t\t$( 'html, body' ).animate( { scrollTop: offsetTop }, 300 );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Disable collapse if it open before.\n\t\t\t\t\t$pageSidebars.each( function() {\n\t\t\t\t\t\tvar $thisSidebar = $( this );\n\t\t\t\t\t\tif ( $thisSidebar.hasClass( COLLAPSIBLE_CLASS ) ) {\n\t\t\t\t\t\t\t$thisSidebar.find( '.widget:not(.' + COLLAPSED_CLASS + ')' ).find( '.widget-content' ).stop().slideDown( collapseDuration );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\t\t// Update Widget Scrollable size.\n\t\t\t\t\tif ( $.fn.perfectScrollbar && ! Helpers.isHandheld() ) {\n\t\t\t\t\t\t$pageSidebars.find( '.widget-scrollable' ).each( function() {\n\t\t\t\t\t\t\t$( this ).find( '.widget-content-inner' ).perfectScrollbar( 'update' );\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tbeforeSend: function() {\n\t\t\t\t\tif ( settings.loadMore ) {\n\t\t\t\t\t\tHelpers.setElementHandling( $btnLoadMore );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tHelpers.setBodyHandling();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcomplete: function() {\n\t\t\t\t\tif ( settings.loadMore ) {\n\t\t\t\t\t\tHelpers.unsetElementHandling( $btnLoadMore );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tHelpers.setBodyCompleted();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\tfunction handlerScrollInfinite() {\n\t\t\tvar $el = $( '.woocommerce-pagination' );\n\n\t\t\tif ( 'infinite' !== $el.data( 'type' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar lastST = 0;\n\t\t\tvar $window = $( window );\n\n\t\t\t$window.on( 'scroll', function() {\n\t\t\t\tvar currentST = $( this ).scrollTop();\n\n\t\t\t\t// Scroll down only.\n\t\t\t\tif ( currentST > lastST ) {\n\t\t\t\t\tvar windowHeight = $window.height(),\n\t\t\t\t\t    // 90% window height.\n\t\t\t\t\t    halfWH       = parseInt( 90 / 100 * windowHeight ),\n\t\t\t\t\t    elOffsetTop  = $el.offset().top,\n\t\t\t\t\t    elHeight     = $el.outerHeight( true ),\n\t\t\t\t\t    offsetTop    = elOffsetTop + elHeight,\n\t\t\t\t\t    finalOffset  = offsetTop - halfWH;\n\n\t\t\t\t\tif ( currentST >= finalOffset ) {\n\t\t\t\t\t\tvar $button = $el.find( '.shop-load-more-button' );\n\n\t\t\t\t\t\tif ( ! $button.hasClass( 'updating-icon' ) ) {\n\t\t\t\t\t\t\t$button.trigger( 'click' );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlastST = currentST;\n\t\t\t} );\n\t\t}\n\n\t\tfunction initArchiveLayoutSwitcher() {\n\t\t\tvar $layoutSwitcher = $( '#archive-layout-switcher' ),\n\t\t\t    $gridWrapper    = $( '.minimog-main-post' ),\n\t\t\t    SELECTED_CLASS  = 'selected';\n\n\t\t\t$layoutSwitcher.on( 'click', '.switcher-item', function( evt ) {\n\t\t\t\tevt.preventDefault();\n\n\t\t\t\tvar $item = $( this );\n\n\t\t\t\tif ( $item.hasClass( SELECTED_CLASS ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t$item.siblings().removeClass( SELECTED_CLASS );\n\t\t\t\t$item.addClass( SELECTED_CLASS );\n\n\t\t\t\tvar newLayout = $item.data( 'layout' );\n\t\t\t\tvar newGridOptions = {};\n\n\t\t\t\t$gridWrapper.addClass( 'layout-switching' );\n\n\t\t\t\tswitch ( newLayout ) {\n\t\t\t\t\tcase 'grid-one':\n\t\t\t\t\t\tnewGridOptions.columns = 1;\n\t\t\t\t\t\tnewGridOptions.disableColumnChange = true;\n\t\t\t\t\t\t$gridWrapper.addClass( 'style-list' );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'grid-two':\n\t\t\t\t\t\tnewGridOptions.columns = 2;\n\t\t\t\t\t\tnewGridOptions.disableColumnChange = false;\n\t\t\t\t\t\t$gridWrapper.removeClass( 'style-list' );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'grid-three':\n\t\t\t\t\t\tnewGridOptions.columns = 3;\n\t\t\t\t\t\tnewGridOptions.disableColumnChange = false;\n\t\t\t\t\t\t$gridWrapper.removeClass( 'style-list' );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'grid-four':\n\t\t\t\t\t\tnewGridOptions.columns = 4;\n\t\t\t\t\t\tnewGridOptions.disableColumnChange = false;\n\t\t\t\t\t\t$gridWrapper.removeClass( 'style-list' );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'grid-five':\n\t\t\t\t\t\tnewGridOptions.columns = 5;\n\t\t\t\t\t\tnewGridOptions.disableColumnChange = false;\n\t\t\t\t\t\t$gridWrapper.removeClass( 'style-list' );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\t$gridWrapper.MinimogGridLayout( 'updateLayout', newGridOptions );\n\t\t\t\t$gridWrapper.on( 'MinimogGridLayoutResized', function() {\n\t\t\t\t\t$gridWrapper.removeClass( 'layout-switching' );\n\t\t\t\t} );\n\t\t\t} );\n\t\t}\n\n\t\tfunction initArchiveSidebarWidgetsCollapsible() {\n\t\t\tif ( 0 >= $pageSidebars.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$pageSidebars.find( '.widget' ).each( function() {\n\t\t\t\tvar $widget = $( this );\n\n\t\t\t\tif ( $widget.hasClass( 'widget_block' ) ) { // Fix block group.\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\t// Wrap content with new div.\n\t\t\t\t$widget.children().not( '.widget-title, .widgettitle, .widget-instance, .widget-content' ).wrapAll( '<div class=\"widget-content\"><div class=\"widget-content-inner\"></div></div>' );\n\n\t\t\t\tif ( $widget.hasClass( 'widget-scrollable' ) && $.fn.perfectScrollbar && ! Helpers.isHandheld() ) {\n\t\t\t\t\t$widget.find( '.widget-content-inner' ).perfectScrollbar();\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t$pageSidebars.each( function() {\n\t\t\t\tvar $thisSidebar = $( this );\n\t\t\t\tif ( $thisSidebar.hasClass( COLLAPSIBLE_CLASS ) ) {\n\t\t\t\t\t$thisSidebar.on( 'click', '.widget-title, .widgettitle', function( evt ) {\n\t\t\t\t\t\tvar $widget = $( this ).closest( '.widget' );\n\t\t\t\t\t\tif ( $widget.hasClass( COLLAPSED_CLASS ) ) {\n\t\t\t\t\t\t\t$widget.removeClass( COLLAPSED_CLASS );\n\t\t\t\t\t\t\t$widget.find( '.widget-content' ).stop().slideDown( collapseDuration );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$widget.addClass( COLLAPSED_CLASS );\n\t\t\t\t\t\t\t$widget.find( '.widget-content' ).stop().slideUp( collapseDuration );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t}( jQuery )\n);\n"]}